<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>C Discrete Random Variables in R | MATH 340 Notes</title>
  <meta name="description" content="C Discrete Random Variables in R | MATH 340 Notes" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="C Discrete Random Variables in R | MATH 340 Notes" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="C Discrete Random Variables in R | MATH 340 Notes" />
  
  
  

<meta name="author" content="Mike Hitchman" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="R-sim-probability.html"/>
<link rel="next" href="R-continuousRV.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://github.com/mphitchman/math340.git" target="blank">Math 340 Notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="sets.html"><a href="sets.html"><i class="fa fa-check"></i><b>2</b> Sets</a>
<ul>
<li class="chapter" data-level="2.1" data-path="sets.html"><a href="sets.html#algebra-of-sets"><i class="fa fa-check"></i><b>2.1</b> Algebra of Sets</a></li>
<li class="chapter" data-level="2.2" data-path="sets.html"><a href="sets.html#size-of-sets"><i class="fa fa-check"></i><b>2.2</b> Set sizes</a></li>
<li class="chapter" data-level="2.3" data-path="sets.html"><a href="sets.html#sets-in-r"><i class="fa fa-check"></i><b>2.3</b> Sets in R</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="discrete-probability-distributions.html"><a href="discrete-probability-distributions.html"><i class="fa fa-check"></i><b>3</b> Discrete Probability Distributions</a>
<ul>
<li class="chapter" data-level="3.1" data-path="discrete-probability-distributions.html"><a href="discrete-probability-distributions.html#sample-space"><i class="fa fa-check"></i><b>3.1</b> Sample Space</a></li>
<li class="chapter" data-level="3.2" data-path="discrete-probability-distributions.html"><a href="discrete-probability-distributions.html#discrete-rv-initial"><i class="fa fa-check"></i><b>3.2</b> Discrete Random Variables</a></li>
<li class="chapter" data-level="3.3" data-path="discrete-probability-distributions.html"><a href="discrete-probability-distributions.html#calculating-probabilities"><i class="fa fa-check"></i><b>3.3</b> Calculating Probabilities</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="discrete-probability-distributions.html"><a href="discrete-probability-distributions.html#sample-point-method"><i class="fa fa-check"></i><b>3.3.1</b> Sample Point Method</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="counting.html"><a href="counting.html"><i class="fa fa-check"></i><b>4</b> Counting Techniques</a>
<ul>
<li class="chapter" data-level="4.1" data-path="counting.html"><a href="counting.html#multipiclation-principle"><i class="fa fa-check"></i><b>4.1</b> Multipiclation Principle</a></li>
<li class="chapter" data-level="4.2" data-path="counting.html"><a href="counting.html#permutations"><i class="fa fa-check"></i><b>4.2</b> Permutations</a></li>
<li class="chapter" data-level="4.3" data-path="counting.html"><a href="counting.html#combinations"><i class="fa fa-check"></i><b>4.3</b> Combinations</a></li>
<li class="chapter" data-level="4.4" data-path="counting.html"><a href="counting.html#multinomial-coefficients"><i class="fa fa-check"></i><b>4.4</b> Multinomial Coefficients</a></li>
<li class="chapter" data-level="4.5" data-path="counting.html"><a href="counting.html#balls-and-bins"><i class="fa fa-check"></i><b>4.5</b> Balls and Bins</a></li>
<li class="chapter" data-level="4.6" data-path="counting.html"><a href="counting.html#prob-with-counting-tools"><i class="fa fa-check"></i><b>4.6</b> Calculating More Probabilities</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="probability-theory.html"><a href="probability-theory.html"><i class="fa fa-check"></i><b>5</b> Probability Theory</a>
<ul>
<li class="chapter" data-level="5.1" data-path="probability-theory.html"><a href="probability-theory.html#conditional-probability-and-independence"><i class="fa fa-check"></i><b>5.1</b> Conditional Probability and Independence</a></li>
<li class="chapter" data-level="5.2" data-path="probability-theory.html"><a href="probability-theory.html#two-laws-of-probability"><i class="fa fa-check"></i><b>5.2</b> Two Laws of Probability</a></li>
<li class="chapter" data-level="5.3" data-path="probability-theory.html"><a href="probability-theory.html#event-composition-method"><i class="fa fa-check"></i><b>5.3</b> Event-Composition Method</a></li>
<li class="chapter" data-level="5.4" data-path="probability-theory.html"><a href="probability-theory.html#bayes-rule"><i class="fa fa-check"></i><b>5.4</b> Bayes’ Rule</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="discrete-random-variables.html"><a href="discrete-random-variables.html"><i class="fa fa-check"></i><b>6</b> Discrete Random Variables</a>
<ul>
<li class="chapter" data-level="6.1" data-path="discrete-random-variables.html"><a href="discrete-random-variables.html#expected-value"><i class="fa fa-check"></i><b>6.1</b> Expected Value</a></li>
<li class="chapter" data-level="6.2" data-path="discrete-random-variables.html"><a href="discrete-random-variables.html#variance"><i class="fa fa-check"></i><b>6.2</b> Variance</a></li>
<li class="chapter" data-level="6.3" data-path="discrete-random-variables.html"><a href="discrete-random-variables.html#properties-of-expected-value"><i class="fa fa-check"></i><b>6.3</b> Properties of Expected Value</a></li>
<li class="chapter" data-level="6.4" data-path="discrete-random-variables.html"><a href="discrete-random-variables.html#tchebysheffs-theorem"><i class="fa fa-check"></i><b>6.4</b> Tchebysheff’s Theorem</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="important-discrete-rv.html"><a href="important-discrete-rv.html"><i class="fa fa-check"></i><b>7</b> Important Discrete Random Variables</a>
<ul>
<li class="chapter" data-level="7.1" data-path="important-discrete-rv.html"><a href="important-discrete-rv.html#binomial"><i class="fa fa-check"></i><b>7.1</b> Binomial Distributions</a></li>
<li class="chapter" data-level="7.2" data-path="important-discrete-rv.html"><a href="important-discrete-rv.html#geometric"><i class="fa fa-check"></i><b>7.2</b> Geometric Distributions</a></li>
<li class="chapter" data-level="7.3" data-path="important-discrete-rv.html"><a href="important-discrete-rv.html#negative-binomial"><i class="fa fa-check"></i><b>7.3</b> Negative Binomial Distribution</a></li>
<li class="chapter" data-level="7.4" data-path="important-discrete-rv.html"><a href="important-discrete-rv.html#hypergometric"><i class="fa fa-check"></i><b>7.4</b> Hypergeometric Distribution</a></li>
<li class="chapter" data-level="7.5" data-path="important-discrete-rv.html"><a href="important-discrete-rv.html#poisson"><i class="fa fa-check"></i><b>7.5</b> Poisson Distribution</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="important-discrete-rv.html"><a href="important-discrete-rv.html#poisson-process"><i class="fa fa-check"></i><b>7.5.1</b> Poisson Process</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="moments-and-moment-generating-functions.html"><a href="moments-and-moment-generating-functions.html"><i class="fa fa-check"></i><b>8</b> Moments and Moment-Generating Functions</a></li>
<li class="chapter" data-level="9" data-path="continuous-rv.html"><a href="continuous-rv.html"><i class="fa fa-check"></i><b>9</b> Continuous Random Variables</a>
<ul>
<li class="chapter" data-level="9.1" data-path="continuous-rv.html"><a href="continuous-rv.html#distribution-functions"><i class="fa fa-check"></i><b>9.1</b> Distribution Functions</a></li>
<li class="chapter" data-level="9.2" data-path="continuous-rv.html"><a href="continuous-rv.html#expected-value-for-continuous-random-variables"><i class="fa fa-check"></i><b>9.2</b> Expected Value for Continuous Random Variables</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="important-continuous-rv.html"><a href="important-continuous-rv.html"><i class="fa fa-check"></i><b>10</b> Important Continuous Random Variables</a>
<ul>
<li class="chapter" data-level="10.1" data-path="important-continuous-rv.html"><a href="important-continuous-rv.html#uniform-continuous"><i class="fa fa-check"></i><b>10.1</b> Uniform Distribution</a></li>
<li class="chapter" data-level="10.2" data-path="important-continuous-rv.html"><a href="important-continuous-rv.html#exponential-distribution"><i class="fa fa-check"></i><b>10.2</b> Exponential Distribution</a></li>
<li class="chapter" data-level="10.3" data-path="important-continuous-rv.html"><a href="important-continuous-rv.html#normal"><i class="fa fa-check"></i><b>10.3</b> Normal Distribution</a></li>
<li class="chapter" data-level="10.4" data-path="important-continuous-rv.html"><a href="important-continuous-rv.html#gamma-distribution"><i class="fa fa-check"></i><b>10.4</b> Gamma Distribution</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="important-continuous-rv.html"><a href="important-continuous-rv.html#exponential-distribution-1"><i class="fa fa-check"></i><b>10.4.1</b> Exponential Distribution</a></li>
<li class="chapter" data-level="10.4.2" data-path="important-continuous-rv.html"><a href="important-continuous-rv.html#chi-square-distribution"><i class="fa fa-check"></i><b>10.4.2</b> Chi-square distribution</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="important-continuous-rv.html"><a href="important-continuous-rv.html#beta-distribution"><i class="fa fa-check"></i><b>10.5</b> Beta Distribution</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="mgf.html"><a href="mgf.html"><i class="fa fa-check"></i><b>11</b> Moment Generating Functions</a></li>
<li class="chapter" data-level="12" data-path="central-limit-theorem.html"><a href="central-limit-theorem.html"><i class="fa fa-check"></i><b>12</b> Central Limit Theorem</a>
<ul>
<li class="chapter" data-level="12.1" data-path="central-limit-theorem.html"><a href="central-limit-theorem.html#sums-of-random-variables"><i class="fa fa-check"></i><b>12.1</b> Sums of Random Variables</a></li>
<li class="chapter" data-level="12.2" data-path="central-limit-theorem.html"><a href="central-limit-theorem.html#t-distribution"><i class="fa fa-check"></i><b>12.2</b> T distribution</a></li>
<li class="chapter" data-level="12.3" data-path="central-limit-theorem.html"><a href="central-limit-theorem.html#the-central-limit-theorem"><i class="fa fa-check"></i><b>12.3</b> The Central Limit Theorem</a></li>
<li class="chapter" data-level="12.4" data-path="central-limit-theorem.html"><a href="central-limit-theorem.html#normal-approximation-to-a-binomial-distribution"><i class="fa fa-check"></i><b>12.4</b> Normal Approximation to a binomial distribution</a>
<ul>
<li class="chapter" data-level="" data-path="central-limit-theorem.html"><a href="central-limit-theorem.html#continuity-correction"><i class="fa fa-check"></i>Continuity Correction</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="estimation.html"><a href="estimation.html"><i class="fa fa-check"></i><b>13</b> Estimation</a>
<ul>
<li class="chapter" data-level="13.1" data-path="estimation.html"><a href="estimation.html#unbiased-estimators"><i class="fa fa-check"></i><b>13.1</b> Unbiased Estimators</a></li>
<li class="chapter" data-level="13.2" data-path="estimation.html"><a href="estimation.html#order-statistics"><i class="fa fa-check"></i><b>13.2</b> Order Statistics</a></li>
<li class="chapter" data-level="13.3" data-path="estimation.html"><a href="estimation.html#common-unbiased-estimators"><i class="fa fa-check"></i><b>13.3</b> Common Unbiased Estimators</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="estimation.html"><a href="estimation.html#estimating-mu-a-population-mean"><i class="fa fa-check"></i><b>13.3.1</b> Estimating <span class="math inline">\(\mu,\)</span> a population mean</a></li>
<li class="chapter" data-level="13.3.2" data-path="estimation.html"><a href="estimation.html#estimating-p-a-population-proportion"><i class="fa fa-check"></i><b>13.3.2</b> Estimating <span class="math inline">\(p,\)</span> a population proportion</a></li>
<li class="chapter" data-level="13.3.3" data-path="estimation.html"><a href="estimation.html#estimating-mu_1---mu_2-the-difference-of-two-population-means"><i class="fa fa-check"></i><b>13.3.3</b> Estimating <span class="math inline">\(\mu_1 - \mu_2,\)</span> the difference of two population means</a></li>
<li class="chapter" data-level="13.3.4" data-path="estimation.html"><a href="estimation.html#estimating-p_1---p_2-the-difference-of-two-population-proportions"><i class="fa fa-check"></i><b>13.3.4</b> Estimating <span class="math inline">\(p_1 - p_2,\)</span> the difference of two population proportions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="confidence-intervals.html"><a href="confidence-intervals.html"><i class="fa fa-check"></i><b>14</b> Confidence Intervals</a>
<ul>
<li class="chapter" data-level="14.1" data-path="confidence-intervals.html"><a href="confidence-intervals.html#pivotal-quantities"><i class="fa fa-check"></i><b>14.1</b> Pivotal Quantities</a></li>
<li class="chapter" data-level="14.2" data-path="confidence-intervals.html"><a href="confidence-intervals.html#large-sample-confidence-intervals"><i class="fa fa-check"></i><b>14.2</b> Large sample confidence intervals</a>
<ul>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#confidence-intervals-for-mu_1-mu_2"><i class="fa fa-check"></i>Confidence Intervals for <span class="math inline">\(\mu_1-\mu_2\)</span></a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Using R</b></span></li>
<li class="chapter" data-level="A" data-path="sampling-in-R.html"><a href="sampling-in-R.html"><i class="fa fa-check"></i><b>A</b> Sampling in R</a>
<ul>
<li class="chapter" data-level="A.1" data-path="sampling-in-R.html"><a href="sampling-in-R.html#vectors-R"><i class="fa fa-check"></i><b>A.1</b> Data vectors</a>
<ul>
<li class="chapter" data-level="" data-path="sampling-in-R.html"><a href="sampling-in-R.html#vector-types"><i class="fa fa-check"></i>vector types</a></li>
<li class="chapter" data-level="" data-path="sampling-in-R.html"><a href="sampling-in-R.html#matrices"><i class="fa fa-check"></i>matrices</a></li>
<li class="chapter" data-level="" data-path="sampling-in-R.html"><a href="sampling-in-R.html#data-frames"><i class="fa fa-check"></i>data frames</a></li>
<li class="chapter" data-level="" data-path="sampling-in-R.html"><a href="sampling-in-R.html#common-vector-commands"><i class="fa fa-check"></i>common vector commands</a></li>
<li class="chapter" data-level="" data-path="sampling-in-R.html"><a href="sampling-in-R.html#comparison-operators"><i class="fa fa-check"></i>comparison operators</a></li>
<li class="chapter" data-level="" data-path="sampling-in-R.html"><a href="sampling-in-R.html#checking-membership"><i class="fa fa-check"></i>checking membership</a></li>
<li class="chapter" data-level="" data-path="sampling-in-R.html"><a href="sampling-in-R.html#sum-and-which"><i class="fa fa-check"></i><code>sum()</code> and <code>which()</code></a></li>
<li class="chapter" data-level="" data-path="sampling-in-R.html"><a href="sampling-in-R.html#extracting-elements"><i class="fa fa-check"></i>extracting elements</a></li>
<li class="chapter" data-level="" data-path="sampling-in-R.html"><a href="sampling-in-R.html#comparing-vectors"><i class="fa fa-check"></i>comparing vectors</a></li>
<li class="chapter" data-level="" data-path="sampling-in-R.html"><a href="sampling-in-R.html#vector-arithmetic"><i class="fa fa-check"></i>vector arithmetic</a></li>
<li class="chapter" data-level="" data-path="sampling-in-R.html"><a href="sampling-in-R.html#concatenate-vectors"><i class="fa fa-check"></i>concatenate vectors</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="sampling-in-R.html"><a href="sampling-in-R.html#special-vectors"><i class="fa fa-check"></i><b>A.2</b> Special vectors</a>
<ul>
<li class="chapter" data-level="" data-path="sampling-in-R.html"><a href="sampling-in-R.html#consecutive-integers"><i class="fa fa-check"></i>consecutive integers</a></li>
<li class="chapter" data-level="" data-path="sampling-in-R.html"><a href="sampling-in-R.html#letters"><i class="fa fa-check"></i>letters</a></li>
<li class="chapter" data-level="" data-path="sampling-in-R.html"><a href="sampling-in-R.html#rep"><i class="fa fa-check"></i><code>rep()</code></a></li>
<li class="chapter" data-level="" data-path="sampling-in-R.html"><a href="sampling-in-R.html#table"><i class="fa fa-check"></i><code>table()</code></a></li>
<li class="chapter" data-level="" data-path="sampling-in-R.html"><a href="sampling-in-R.html#seq"><i class="fa fa-check"></i><code>seq()</code></a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="sampling-in-R.html"><a href="sampling-in-R.html#sampling-in-R-section"><i class="fa fa-check"></i><b>A.3</b> Sampling</a>
<ul>
<li class="chapter" data-level="" data-path="sampling-in-R.html"><a href="sampling-in-R.html#sample-options"><i class="fa fa-check"></i><code>sample()</code> options</a></li>
<li class="chapter" data-level="" data-path="sampling-in-R.html"><a href="sampling-in-R.html#sample-without-replacement"><i class="fa fa-check"></i>sample without replacement</a></li>
<li class="chapter" data-level="" data-path="sampling-in-R.html"><a href="sampling-in-R.html#sample-with-replacement"><i class="fa fa-check"></i>sample with replacement</a></li>
<li class="chapter" data-level="" data-path="sampling-in-R.html"><a href="sampling-in-R.html#sample-with-custom-probabilities"><i class="fa fa-check"></i>sample with custom probabilities</a></li>
<li class="chapter" data-level="" data-path="sampling-in-R.html"><a href="sampling-in-R.html#example-lefties"><i class="fa fa-check"></i>example: lefties</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="sampling-in-R.html"><a href="sampling-in-R.html#repeated-sampling"><i class="fa fa-check"></i><b>A.4</b> Repeated sampling</a>
<ul>
<li class="chapter" data-level="" data-path="sampling-in-R.html"><a href="sampling-in-R.html#using-a-for-loop"><i class="fa fa-check"></i>using a <code>for</code> loop</a></li>
<li class="chapter" data-level="" data-path="sampling-in-R.html"><a href="sampling-in-R.html#using-replicate"><i class="fa fa-check"></i>using <code>replicate()</code></a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="sampling-in-R.html"><a href="sampling-in-R.html#sampling-commands"><i class="fa fa-check"></i><b>A.5</b> Summary of R commands</a>
<ul>
<li class="chapter" data-level="" data-path="sampling-in-R.html"><a href="sampling-in-R.html#defining-vectors"><i class="fa fa-check"></i>defining vectors</a></li>
<li class="chapter" data-level="" data-path="sampling-in-R.html"><a href="sampling-in-R.html#summarizing-vectors"><i class="fa fa-check"></i>summarizing vectors</a></li>
<li class="chapter" data-level="" data-path="sampling-in-R.html"><a href="sampling-in-R.html#sampling-from-vectors"><i class="fa fa-check"></i>sampling from vectors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="R-sim-probability.html"><a href="R-sim-probability.html"><i class="fa fa-check"></i><b>B</b> Simulating Probability in R</a>
<ul>
<li class="chapter" data-level="B.1" data-path="R-sim-probability.html"><a href="R-sim-probability.html#diff-2dice-R"><i class="fa fa-check"></i><b>B.1</b> Difference of two dice</a></li>
<li class="chapter" data-level="B.2" data-path="R-sim-probability.html"><a href="R-sim-probability.html#license-plates-R"><i class="fa fa-check"></i><b>B.2</b> Oregon License Plates</a></li>
<li class="chapter" data-level="B.3" data-path="R-sim-probability.html"><a href="R-sim-probability.html#id_10sided-die-R"><i class="fa fa-check"></i><b>B.3</b> Rolling a 10-sided die</a></li>
<li class="chapter" data-level="B.4" data-path="R-sim-probability.html"><a href="R-sim-probability.html#marbles-urn-R"><i class="fa fa-check"></i><b>B.4</b> Marbles from an urn</a></li>
<li class="chapter" data-level="B.5" data-path="R-sim-probability.html"><a href="R-sim-probability.html#flip-coin-R"><i class="fa fa-check"></i><b>B.5</b> Tracking runs of Heads in coin flips</a></li>
<li class="chapter" data-level="B.6" data-path="R-sim-probability.html"><a href="R-sim-probability.html#partition-set-R"><i class="fa fa-check"></i><b>B.6</b> Splitting a set into multiple subsets</a></li>
<li class="chapter" data-level="B.7" data-path="R-sim-probability.html"><a href="R-sim-probability.html#pollsters-R"><i class="fa fa-check"></i><b>B.7</b> Pollsters</a></li>
<li class="chapter" data-level="B.8" data-path="R-sim-probability.html"><a href="R-sim-probability.html#same-birthday-R"><i class="fa fa-check"></i><b>B.8</b> Matching Birthdays</a></li>
<li class="chapter" data-level="B.9" data-path="R-sim-probability.html"><a href="R-sim-probability.html#flipping-coins-with-fibonacci"><i class="fa fa-check"></i><b>B.9</b> Flipping Coins with Fibonacci</a></li>
<li class="chapter" data-level="B.10" data-path="R-sim-probability.html"><a href="R-sim-probability.html#seats-on-an-airplane"><i class="fa fa-check"></i><b>B.10</b> Seats on an airplane</a></li>
<li class="chapter" data-level="B.11" data-path="R-sim-probability.html"><a href="R-sim-probability.html#drawing-names-for-homemades"><i class="fa fa-check"></i><b>B.11</b> Drawing names for Homemades</a>
<ul>
<li class="chapter" data-level="" data-path="R-sim-probability.html"><a href="R-sim-probability.html#mathematical-addendum-to-the-question-of-drawing-names."><i class="fa fa-check"></i>Mathematical addendum to the question of drawing names.</a></li>
</ul></li>
<li class="chapter" data-level="B.12" data-path="R-sim-probability.html"><a href="R-sim-probability.html#idiots-delight"><i class="fa fa-check"></i><b>B.12</b> Idiot’s Delight</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="R-discreteRV.html"><a href="R-discreteRV.html"><i class="fa fa-check"></i><b>C</b> Discrete Random Variables in R</a>
<ul>
<li class="chapter" data-level="C.1" data-path="R-discreteRV.html"><a href="R-discreteRV.html#binomialR"><i class="fa fa-check"></i><b>C.1</b> Binomial <code>binom</code></a>
<ul>
<li class="chapter" data-level="" data-path="R-discreteRV.html"><a href="R-discreteRV.html#dbinom---probability-function"><i class="fa fa-check"></i><code>dbinom()</code> - probability function</a></li>
<li class="chapter" data-level="" data-path="R-discreteRV.html"><a href="R-discreteRV.html#pbinom---cumulative-probability"><i class="fa fa-check"></i><code>pbinom()</code> - cumulative probability</a></li>
<li class="chapter" data-level="" data-path="R-discreteRV.html"><a href="R-discreteRV.html#qbinom---quantiles"><i class="fa fa-check"></i><code>qbinom()</code> - quantiles</a></li>
<li class="chapter" data-level="" data-path="R-discreteRV.html"><a href="R-discreteRV.html#rbinom---sampling"><i class="fa fa-check"></i><code>rbinom()</code> - sampling</a></li>
</ul></li>
<li class="chapter" data-level="C.2" data-path="R-discreteRV.html"><a href="R-discreteRV.html#geometricR"><i class="fa fa-check"></i><b>C.2</b> Geometric <code>geom</code></a></li>
<li class="chapter" data-level="C.3" data-path="R-discreteRV.html"><a href="R-discreteRV.html#negbinomR"><i class="fa fa-check"></i><b>C.3</b> Negative Binomial <code>nbinom</code></a></li>
<li class="chapter" data-level="C.4" data-path="R-discreteRV.html"><a href="R-discreteRV.html#hyperR"><i class="fa fa-check"></i><b>C.4</b> Hypergeometric <code>hyper</code></a></li>
<li class="chapter" data-level="C.5" data-path="R-discreteRV.html"><a href="R-discreteRV.html#poissonR"><i class="fa fa-check"></i><b>C.5</b> Poisson <code>pois</code></a></li>
<li class="chapter" data-level="C.6" data-path="R-discreteRV.html"><a href="R-discreteRV.html#custom-discrete-R"><i class="fa fa-check"></i><b>C.6</b> Homemade Discrete Random Variables</a>
<ul>
<li class="chapter" data-level="" data-path="R-discreteRV.html"><a href="R-discreteRV.html#expected-value-of-x"><i class="fa fa-check"></i>Expected Value of <span class="math inline">\(X\)</span></a></li>
<li class="chapter" data-level="" data-path="R-discreteRV.html"><a href="R-discreteRV.html#variance-of-x"><i class="fa fa-check"></i>Variance of <span class="math inline">\(X\)</span></a></li>
<li class="chapter" data-level="" data-path="R-discreteRV.html"><a href="R-discreteRV.html#distribution-plots"><i class="fa fa-check"></i>Distribution Plots</a></li>
<li class="chapter" data-level="" data-path="R-discreteRV.html"><a href="R-discreteRV.html#sampling"><i class="fa fa-check"></i>Sampling</a></li>
<li class="chapter" data-level="C.6.1" data-path="R-discreteRV.html"><a href="R-discreteRV.html#discrete-uniform-distribution"><i class="fa fa-check"></i><b>C.6.1</b> Discrete Uniform Distribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="D" data-path="R-continuousRV.html"><a href="R-continuousRV.html"><i class="fa fa-check"></i><b>D</b> Continuous Random Variables in R</a>
<ul>
<li class="chapter" data-level="D.1" data-path="R-continuousRV.html"><a href="R-continuousRV.html#unifR"><i class="fa fa-check"></i><b>D.1</b> Uniform Distribution</a>
<ul>
<li class="chapter" data-level="" data-path="R-continuousRV.html"><a href="R-continuousRV.html#picking-random-numbers"><i class="fa fa-check"></i>Picking random numbers</a></li>
<li class="chapter" data-level="" data-path="R-continuousRV.html"><a href="R-continuousRV.html#picking-random-points-in-the-unit-square"><i class="fa fa-check"></i>Picking random points in the unit square</a></li>
<li class="chapter" data-level="" data-path="R-continuousRV.html"><a href="R-continuousRV.html#estimate-the-value-of-pi"><i class="fa fa-check"></i>Estimate the value of <span class="math inline">\(\pi\)</span></a></li>
</ul></li>
<li class="chapter" data-level="D.2" data-path="R-continuousRV.html"><a href="R-continuousRV.html#normalR"><i class="fa fa-check"></i><b>D.2</b> Normal Distribution <code>norm</code></a>
<ul>
<li class="chapter" data-level="" data-path="R-continuousRV.html"><a href="R-continuousRV.html#sampling-distribution-of-a-sample-mean"><i class="fa fa-check"></i>Sampling Distribution of a sample mean</a></li>
</ul></li>
<li class="chapter" data-level="D.3" data-path="R-continuousRV.html"><a href="R-continuousRV.html#expR"><i class="fa fa-check"></i><b>D.3</b> Exponential Distribution <code>exp</code></a>
<ul>
<li class="chapter" data-level="" data-path="R-continuousRV.html"><a href="R-continuousRV.html#a-memoryless-distribution"><i class="fa fa-check"></i>A Memoryless distribution</a></li>
</ul></li>
<li class="chapter" data-level="D.4" data-path="R-continuousRV.html"><a href="R-continuousRV.html#gammaR"><i class="fa fa-check"></i><b>D.4</b> Gamma Distribution <code>gamma</code></a></li>
<li class="chapter" data-level="D.5" data-path="R-continuousRV.html"><a href="R-continuousRV.html#chiR"><i class="fa fa-check"></i><b>D.5</b> Chi-square Distribution <code>chisq</code></a></li>
<li class="chapter" data-level="D.6" data-path="R-continuousRV.html"><a href="R-continuousRV.html#betaR"><i class="fa fa-check"></i><b>D.6</b> Beta distribution <code>beta</code></a></li>
<li class="chapter" data-level="D.7" data-path="R-continuousRV.html"><a href="R-continuousRV.html#custom-continuous-R"><i class="fa fa-check"></i><b>D.7</b> Homemade Continuous Random Variables</a>
<ul>
<li class="chapter" data-level="" data-path="R-continuousRV.html"><a href="R-continuousRV.html#input-the-density-function"><i class="fa fa-check"></i>Input the density function</a></li>
<li class="chapter" data-level="" data-path="R-continuousRV.html"><a href="R-continuousRV.html#visualize-the-density-function"><i class="fa fa-check"></i>Visualize the density function</a></li>
<li class="chapter" data-level="" data-path="R-continuousRV.html"><a href="R-continuousRV.html#estimating-integrals-with-riemann-sums"><i class="fa fa-check"></i>Estimating Integrals with Riemann Sums</a></li>
<li class="chapter" data-level="" data-path="R-continuousRV.html"><a href="R-continuousRV.html#estimating-probabilities"><i class="fa fa-check"></i>Estimating Probabilities</a></li>
<li class="chapter" data-level="" data-path="R-continuousRV.html"><a href="R-continuousRV.html#the-distribution-function-fx"><i class="fa fa-check"></i>The distribution function <span class="math inline">\(F(X)\)</span></a></li>
<li class="chapter" data-level="" data-path="R-continuousRV.html"><a href="R-continuousRV.html#estimating-moments"><i class="fa fa-check"></i>Estimating Moments</a></li>
<li class="chapter" data-level="" data-path="R-continuousRV.html"><a href="R-continuousRV.html#expected-value-1"><i class="fa fa-check"></i>Expected Value</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">MATH 340 Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="R-discreteRV" class="section level1 hasAnchor" number="17">
<h1><span class="header-section-number">C</span> Discrete Random Variables in R<a href="R-discreteRV.html#R-discreteRV" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Here we investigate in R the common, named discrete random variables we encounter in MATH 340:</p>
<ul>
<li><a href="R-discreteRV.html#binomialR">binomial</a> | <code>binom</code></li>
<li><a href="R-discreteRV.html#geometricR">geometric</a> | <code>geom</code></li>
<li><a href="R-discreteRV.html#negbinomR">negative binomial</a> | <code>nbinom</code></li>
<li><a href="R-discreteRV.html#hyperR">hypergeometric</a> | <code>hyper</code></li>
<li><a href="R-discreteRV.html#poissonR">Poisson</a> | <code>pois</code></li>
</ul>
<p>We use four commands to work with the named distributions. For a distribution named <code>___</code>:</p>
<ul>
<li><code>d___(x,...)</code> | probability function, <span class="math inline">\(p(x)\)</span></li>
<li><code>p___(q,...)</code> | Cumulative probability, <span class="math inline">\(P(X \leq q)\)</span></li>
<li><code>q___(p,...)</code> | Quantiles, finds <span class="math inline">\(x\)</span> such that <span class="math inline">\(P(X \leq x) = p\)</span></li>
<li><code>r___(n,...)</code> | Random sample of size <span class="math inline">\(n\)</span> from the distribution</li>
</ul>
<p>We also discuss below how to build and analyze <a href="R-discreteRV.html#custom-discrete-R">homemade discrete random variables in R</a>.</p>
<div id="binomialR" class="section level2 hasAnchor" number="17.1">
<h2><span class="header-section-number">C.1</span> Binomial <code>binom</code><a href="R-discreteRV.html#binomialR" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>The Scene</strong></p>
<p>Recall, <span class="math inline">\(X \sim \texttt{binom}(n,p)\)</span> means <span class="math inline">\(X\)</span> counts the number of successes in <span class="math inline">\(n\)</span> independent, identical Bernoulli trials, when probability of success on any given trial is <span class="math inline">\(p\)</span>.</p>
<p><strong>The space of <span class="math inline">\(X\)</span></strong> is <span class="math inline">\(x = 0, 1, \ldots, n\)</span>.</p>
<p><strong>Probability function</strong><br />
For <span class="math inline">\(x = 0, 1, \ldots, n,\)</span> <span class="math display">\[p(x)=\binom{n}{x}p^x(1-p)^{n-x}.\]</span></p>
<p><strong>The binomial distribution in R</strong></p>
<div id="dbinom---probability-function" class="section level3 unnumbered hasAnchor">
<h3><code>dbinom()</code> - probability function<a href="R-discreteRV.html#dbinom---probability-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p><code>dbinom(x,n,p)</code> returns the probability <span class="math inline">\(P(X = x)\)</span> for <span class="math inline">\(X \sim \texttt{binom}(n,p)\)</span>.</p>
</blockquote>
<p>For instance, <code>dbinom(2,5,.3)</code> returns <span class="math display">\[\binom{5}{2}(.3)^2(.7)^3.\]</span></p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="R-discreteRV.html#cb236-1" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">2</span>,<span class="dv">5</span>,.<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.3087</code></pre>
<p>As a check:</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="R-discreteRV.html#cb238-1" tabindex="-1"></a><span class="fu">choose</span>(<span class="dv">5</span>,<span class="dv">2</span>)<span class="sc">*</span>(.<span class="dv">3</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(.<span class="dv">7</span>)<span class="sc">^</span><span class="dv">3</span></span></code></pre></div>
<pre><code>## [1] 0.3087</code></pre>
</div>
<div id="pbinom---cumulative-probability" class="section level3 unnumbered hasAnchor">
<h3><code>pbinom()</code> - cumulative probability<a href="R-discreteRV.html#pbinom---cumulative-probability" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p><code>pbinom(q,n,p)</code>returns the cumulative probability <span class="math inline">\(P(X \leq q)\)</span> for <span class="math inline">\(X \sim \text{binom}(n,p)\)</span>: <span class="math display">\[\sum_{x=0}^q p(x)=\sum_{x=0}^q\binom{n}{x}p^x(1-p)^{n-x}.\]</span></p>
</blockquote>
<p>So <code>pbinom(2,5,.3)</code> returns <span class="math inline">\(P(X \leq 2)\)</span> when <span class="math inline">\(X\)</span> is <span class="math inline">\(\texttt{binom}(5,.3)\)</span>:</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="R-discreteRV.html#cb240-1" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">2</span>,<span class="dv">5</span>,.<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.83692</code></pre>
<p>As a check:</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="R-discreteRV.html#cb242-1" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">0</span>,<span class="dv">5</span>,.<span class="dv">3</span>)<span class="sc">+</span><span class="fu">dbinom</span>(<span class="dv">1</span>,<span class="dv">5</span>,.<span class="dv">3</span>)<span class="sc">+</span><span class="fu">dbinom</span>(<span class="dv">2</span>,<span class="dv">5</span>,.<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.83692</code></pre>
</div>
<div id="qbinom---quantiles" class="section level3 unnumbered hasAnchor">
<h3><code>qbinom()</code> - quantiles<a href="R-discreteRV.html#qbinom---quantiles" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Recall the definition of quantile (<a href="continuous-rv.html#def:quantile">9.4</a>): If <span class="math inline">\(0 &lt; p &lt; 1,\)</span> the <span class="math inline">\(p\)</span>th quantile of <span class="math inline">\(X,\)</span> denoted <span class="math inline">\(\phi_p,\)</span> is the smallest value such that <span class="math inline">\(P(X \leq \phi_p) \geq p\)</span>. In other words, the value <span class="math inline">\(\phi_p\)</span> marks the smallest value below which one finds 100*p percent of the distribution of <span class="math inline">\(X\)</span>.</p>
<blockquote>
<p><code>qbinom(q,n,p)</code> returns the quantile <span class="math inline">\(\phi_q\)</span> for <span class="math inline">\(X \sim \texttt{binom}(n,p)\)</span></p>
</blockquote>
<p>For instance, what value marks the 95th percentile of the <span class="math inline">\(\texttt{binom}(100,.5)\)</span> distribution?</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="R-discreteRV.html#cb244-1" tabindex="-1"></a><span class="fu">qbinom</span>(.<span class="dv">95</span>,<span class="dv">100</span>,.<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 58</code></pre>
<p>So, if you flip a fair coin 100 times and count how many heads you get, about 95% of the time you would flip less than or equal to 58 heads.</p>
<p>We can check this:</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="R-discreteRV.html#cb246-1" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">58</span>,<span class="dv">100</span>,.<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 0.955687</code></pre>
</div>
<div id="rbinom---sampling" class="section level3 unnumbered hasAnchor">
<h3><code>rbinom()</code> - sampling<a href="R-discreteRV.html#rbinom---sampling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p><code>rbinom(10,20,.4)</code> will generate a vector that stores a random sample of size 10 drawn from a <span class="math inline">\(\texttt{binom}(20,.4)\)</span> distribution.</p>
</blockquote>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="R-discreteRV.html#cb248-1" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="dv">10</span>,<span class="dv">20</span>,.<span class="dv">4</span>)</span></code></pre></div>
<pre><code>##  [1]  7  7  5 11 10  9  6  6  7  8</code></pre>
<p>We can use <code>r___</code> to run simulations, and to visualize the shape of a distribution.</p>
<p>Two useful commands for summarizing data: <code>table()</code> presents the frequency table for the sample, and <code>barplot(table())</code> is a quick way to visualize this frequency table.</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="R-discreteRV.html#cb250-1" tabindex="-1"></a>sim_data <span class="ot">=</span> <span class="fu">rbinom</span>(<span class="dv">1000</span>,<span class="dv">20</span>,.<span class="dv">4</span>) <span class="co"># sample of size 1000 from binom(20,.4).</span></span>
<span id="cb250-2"><a href="R-discreteRV.html#cb250-2" tabindex="-1"></a><span class="fu">table</span>(sim_data)</span></code></pre></div>
<pre><code>## sim_data
##   2   3   4   5   6   7   8   9  10  11  12  13  14  15 
##   3   8  36  77 106 160 161 181 130  82  36  12   7   1</code></pre>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="R-discreteRV.html#cb252-1" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(sim_data))</span></code></pre></div>
<p><img src="math340-notes_files/figure-html/unnamed-chunk-168-1.png" width="480" /></p>
</div>
</div>
<div id="geometricR" class="section level2 hasAnchor" number="17.2">
<h2><span class="header-section-number">C.2</span> Geometric <code>geom</code><a href="R-discreteRV.html#geometricR" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>The Scene</strong><br />
Let the random variable <span class="math inline">\(X\)</span> denote the number of identical, independent Bernoulli trials (with probability of success <span class="math inline">\(p,\)</span> probability of failure <span class="math inline">\(q = 1-p\)</span>) up to and including the first success.
Then <span class="math inline">\(X\)</span> is called a <em>geometric random variable</em> with parameter <span class="math inline">\(p\)</span>.</p>
<p><strong>Notation</strong><br />
<span class="math inline">\(X\)</span> is <span class="math inline">\((p)\)</span>.</p>
<p><strong>The space of <span class="math inline">\(X\)</span></strong> is <span class="math inline">\(x = 1, 2, \ldots\)</span></p>
<p><strong>Probability function</strong><br />
For <span class="math inline">\(x = 1, 2, 3, \ldots,\)</span> <span class="math display">\[p(x)= q^{x-1}p.\]</span></p>
<p><strong>NOTE</strong>: The geometric distribution in R counts failures, not total trials.</p>
<p>In R <code>geom</code> counts the number of failures until the first success, not the total number of trials up to and including the first success.</p>
<p>As with the <code>binom</code> distribution, we can use the <code>d___</code>, <code>p___</code>, <code>q___</code>, and <code>r___</code> commands to determine probability for particular values of <span class="math inline">\(x,\)</span> cumulative probabilities, quantiles, and random samples, respectively.</p>
<blockquote>
<p><code>dgeom(4,.3)</code> gives the probability of seeing 4 failures before the first success in a Bernoulli trial in which <span class="math inline">\(p = .3\)</span></p>
</blockquote>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="R-discreteRV.html#cb253-1" tabindex="-1"></a><span class="fu">dgeom</span>(<span class="dv">4</span>,.<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.07203</code></pre>
<blockquote>
<p><code>pgeom(4,.3)</code> gives the probability of seeing 4 or fewer failures before the first success in a sequence of Bernoulli trials in which <span class="math inline">\(p = .3\)</span></p>
</blockquote>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="R-discreteRV.html#cb255-1" tabindex="-1"></a><span class="fu">pgeom</span>(<span class="dv">4</span>,.<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.83193</code></pre>
<p>and the following line gives the probability of seeing more than 4 failures prior to the first success:</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="R-discreteRV.html#cb257-1" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pgeom</span>(<span class="dv">4</span>,.<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.16807</code></pre>
<div class="example">
<p><span id="exm:roll-until-4-R" class="example"><strong>Example C.1  </strong></span></p>
<blockquote>
<p>Roll a fair 6-sided die until a four comes up, and let <span class="math inline">\(X\)</span> denote the rolls up needed to see that first four. Repeat this game 10,000 times, and plot the frequency distribution for <span class="math inline">\(X\)</span>.</p>
</blockquote>
<p>Strategy:</p>
<ol style="list-style-type: decimal">
<li>Note that this game is a Bernoulli trial, where “success” means rolling a 4 and “failure” means not rolling a four. So <span class="math inline">\(p = 1/6,\)</span> and <span class="math inline">\(q = 5/6\)</span>.<br />
</li>
<li>Take a random sample of size 10000 from the <code>geom</code> distribution in R with the <code>rgeom()</code> method (which records the number of failures, not the number of trials).</li>
<li>Add one to each value in the sample to get the number of trials.</li>
<li>barplot the table!</li>
</ol>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="R-discreteRV.html#cb259-1" tabindex="-1"></a>results<span class="ot">=</span><span class="fu">rgeom</span>(<span class="dv">10000</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>)<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb259-2"><a href="R-discreteRV.html#cb259-2" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(results))</span></code></pre></div>
<p><img src="math340-notes_files/figure-html/unnamed-chunk-172-1.png" width="672" /></p>
<p>OMG notice from the bar plot that one depressing game required 44 rolls to see my first 4.</p>
</div>
</div>
<div id="negbinomR" class="section level2 hasAnchor" number="17.3">
<h2><span class="header-section-number">C.3</span> Negative Binomial <code>nbinom</code><a href="R-discreteRV.html#negbinomR" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>The Scene</strong><br />
Again, we consider a sequence of Bernoulli trials (probability of success is <span class="math inline">\(p,\)</span> probability of failure is <span class="math inline">\(q = 1-p\)</span>).</p>
<p>We let <span class="math inline">\(X\)</span> denote the number of trials in the sequence up to and including the <span class="math inline">\(r\)</span>th success, where <span class="math inline">\(r \geq 1\)</span> is a positive integer. Then <span class="math inline">\(X\)</span> is called a <em>negative binomial random variable</em> with parameters <span class="math inline">\(p\)</span> and <span class="math inline">\(r\)</span>.</p>
<p><strong>Notation</strong>: <span class="math inline">\(X\)</span> is <span class="math inline">\(\texttt{nbinom}(r,p)\)</span></p>
<p><strong>The space of <span class="math inline">\(X\)</span></strong> is <span class="math inline">\(x = r, r+1, r+2, \ldots\)</span></p>
<p><strong>Probability function</strong><br />
For <span class="math inline">\(x = r, r+1, r+2, \ldots ,\)</span> <span class="math display">\[p(x)= \binom{x-1}{r-1}p^{r}q^{x-r}.\]</span></p>
<div class="example">
<p><span id="exm:drill-oil-negbinom-R" class="example"><strong>Example C.2  </strong></span>A study indicates that an exploratory oil well drilled in a particular region should strike oil with probability 0.2. Find the probability that the third oil strike comes on the 10th well drilled.</p>
<p>Here, if <span class="math inline">\(X\)</span> equals the number of wells drilled until the company gets its third strike, then <span class="math inline">\(X\)</span> is Nb(3,.2), and the answer to this question is <span class="math inline">\(P(X=10)\)</span> which is <span class="math display">\[P(X=10)=\binom{9}{2}0.2^{3}.8^{7}.\]</span></p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="R-discreteRV.html#cb260-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">choose</span>(<span class="dv">9</span>,<span class="dv">2</span>)<span class="sc">*</span>.<span class="dv">2</span><span class="sc">^</span><span class="dv">3</span><span class="sc">*</span>.<span class="dv">8</span><span class="sc">^</span><span class="dv">7</span>,<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.0604</code></pre>
</div>
<p><strong>In R</strong> this distribution is accessed using <code>nbinom</code>, but this distribution, like <code>geom</code>, focuses on the number of failures, not total trials. If we want to know the probability that our third success occurs on the 10th trial, this is equivalent to the probability of having 10-3 = 7 failures before getting our third success, which can be computed in R as</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="R-discreteRV.html#cb262-1" tabindex="-1"></a><span class="fu">dnbinom</span>(<span class="dv">7</span>,<span class="dv">3</span>,.<span class="dv">2</span>) <span class="co"># 7 failures to get 3rd success, p = .2</span></span></code></pre></div>
<pre><code>## [1] 0.06039798</code></pre>
<p>Visualizing <span class="math inline">\(X \sim \texttt{nbinom}(3,.2)\)</span></p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="R-discreteRV.html#cb264-1" tabindex="-1"></a>r <span class="ot">=</span> <span class="dv">3</span> <span class="co">#going until we get 3rd success</span></span>
<span id="cb264-2"><a href="R-discreteRV.html#cb264-2" tabindex="-1"></a>p <span class="ot">=</span> .<span class="dv">2</span> <span class="co">#probability of success on any given Bernoulli trial</span></span>
<span id="cb264-3"><a href="R-discreteRV.html#cb264-3" tabindex="-1"></a>trials <span class="ot">=</span> <span class="dv">10000</span> <span class="co">#trials in this simulation</span></span>
<span id="cb264-4"><a href="R-discreteRV.html#cb264-4" tabindex="-1"></a>failure_count <span class="ot">=</span> <span class="fu">rnbinom</span>(trials,r,p)</span>
<span id="cb264-5"><a href="R-discreteRV.html#cb264-5" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(failure_count),<span class="at">main=</span><span class="st">&quot;failures before 3rd success&quot;</span>)</span></code></pre></div>
<p><img src="math340-notes_files/figure-html/unnamed-chunk-175-1.png" width="672" /></p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="R-discreteRV.html#cb265-1" tabindex="-1"></a>trial_count<span class="ot">=</span>failure_count<span class="sc">+</span>r</span>
<span id="cb265-2"><a href="R-discreteRV.html#cb265-2" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(trial_count),<span class="at">main=</span><span class="st">&quot;X=trials until third success&quot;</span>)</span></code></pre></div>
<p><img src="math340-notes_files/figure-html/unnamed-chunk-176-1.png" width="672" /></p>
</div>
<div id="hyperR" class="section level2 hasAnchor" number="17.4">
<h2><span class="header-section-number">C.4</span> Hypergeometric <code>hyper</code><a href="R-discreteRV.html#hyperR" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>The Scene</strong><br />
A finite population has <span class="math inline">\(N\)</span> elements, each of which possesses one of two possible characteristics. Say we have a jar of <span class="math inline">\(N\)</span> marbles, each is either red or black. Let’s say <span class="math inline">\(m\)</span> of them are red and <span class="math inline">\(n\)</span> of them are black (so <span class="math inline">\(m + n = N\)</span>). We draw a sample of size <span class="math inline">\(k,\)</span> and let <span class="math inline">\(X\)</span> denote the number of red marbles in the jar.</p>
<p>Then <span class="math inline">\(X\)</span> is called a <em>hypergeometric random variable</em> with parameters <span class="math inline">\(m,\)</span> <span class="math inline">\(n,\)</span> and <span class="math inline">\(k\)</span>.</p>
<p><strong>Notation</strong>: <span class="math inline">\(X\)</span> is <span class="math inline">\(\texttt{hyper}(m,n,k)\)</span></p>
<p><strong>The space of <span class="math inline">\(X\)</span></strong> is <span class="math inline">\(x = 0,1,2,\ldots,k\)</span> subject to the restriction that <span class="math inline">\(x \leq m\)</span> and <span class="math inline">\(k - x \leq n\)</span>.</p>
<p><strong>Probability function</strong><br />
The probability function is <span class="math display">\[p(x)= \frac{\binom{m}{x}\binom{n}{k-x}}{\binom{m+n}{k}}.\]</span></p>
<p><strong>In R</strong> Use <code>hyper</code>.</p>
<div class="example">
<p><span id="exm:seals-hyper-R" class="example"><strong>Example C.3  </strong></span></p>
<blockquote>
<p>A group of 6 seals and 4 pelicans hang at the beach, and they select a random subset of size 5 to play beach volleyball. Let <span class="math inline">\(X\)</span> = the number of pelicans chosen.<br />
Here, <span class="math inline">\(X\)</span> is hypergeometric with parameters <span class="math inline">\(m = 4\)</span> (4 pelicans), <span class="math inline">\(n = 6\)</span> (6 seals) and <span class="math inline">\(k = 5\)</span> (sample size).<br />
The probability that <span class="math inline">\(X = 2\)</span> is</p>
</blockquote>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="R-discreteRV.html#cb266-1" tabindex="-1"></a><span class="fu">choose</span>(<span class="dv">4</span>,<span class="dv">2</span>)<span class="sc">*</span><span class="fu">choose</span>(<span class="dv">6</span>,<span class="dv">3</span>)<span class="sc">/</span><span class="fu">choose</span>(<span class="dv">10</span>,<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 0.4761905</code></pre>
<p>We can also use the built in command <code>dhyper(x,m,n,k)</code></p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="R-discreteRV.html#cb268-1" tabindex="-1"></a><span class="fu">dhyper</span>(<span class="at">x=</span><span class="dv">2</span>,<span class="at">m=</span><span class="dv">4</span>,<span class="at">n=</span><span class="dv">6</span>,<span class="at">k=</span><span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 0.4761905</code></pre>
</div>
<div class="example">
<p><span id="exm:potatoes-R" class="example"><strong>Example C.4  (Good Potatoes Bad Potatoes in R) </strong></span></p>
<blockquote>
<p>A truck has 500 potatoes, 50 of which are bad, the rest are good. We sample 10. What is the probability that more than 3 are bad?</p>
</blockquote>
<p>If <span class="math inline">\(X\)</span> equals the number of bad potatoes in the sample, then <span class="math inline">\(X\)</span> is hypergeometric with parameters <span class="math inline">\(m = 50,\)</span> <span class="math inline">\(n=450,\)</span> and <span class="math inline">\(k = 10\)</span>.
So <span class="math display">\[P(X &gt; 3) = 1 - P(X \leq 3)\]</span>
which can be calculated with the cumulative probability command <code>phyper</code>:</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="R-discreteRV.html#cb270-1" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">phyper</span>(<span class="dv">3</span>,<span class="dv">50</span>,<span class="dv">450</span>,<span class="dv">10</span>)</span></code></pre></div>
<pre><code>## [1] 0.01186118</code></pre>
</div>
</div>
<div id="poissonR" class="section level2 hasAnchor" number="17.5">
<h2><span class="header-section-number">C.5</span> Poisson <code>pois</code><a href="R-discreteRV.html#poissonR" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>The Scene</strong><br />
The Poisson probability distribution can provide a good model for the number of occurrences <span class="math inline">\(X\)</span> of a rare event in time, space, or some other unit of measure. A Poisson random variable <span class="math inline">\(X\)</span> has one parameter, <span class="math inline">\(\lambda,\)</span> which is the average number of occurrences of the rare event in the indicated time (or space, etc.)</p>
<p><strong>Notation</strong>: <span class="math inline">\(X\)</span> is <span class="math inline">\(\texttt{Poisson}(\lambda)\)</span>.</p>
<p><strong>The space of <span class="math inline">\(X\)</span></strong> is <span class="math inline">\(x = 0,1,2,\ldots,\)</span> (countably infinite!)</p>
<p><strong>Probability function</strong><br />
The probability function is <span class="math display">\[p(x)=\frac{\lambda^x}{x!}e^{-\lambda}\]</span></p>
<p><strong>In R</strong> use <code>pois</code>.</p>
<div class="example">
<p><span id="exm:poisson-R" class="example"><strong>Example C.5  </strong></span></p>
<blockquote>
<p>Suppose <span class="math inline">\(X\)</span> is Poisson(5). Determine <span class="math inline">\(P(X \geq 10)\)</span>.</p>
</blockquote>
<p>Note: <span class="math inline">\(P(X \geq 10) = 1-P(X &lt; 10)= 1-P(X \leq 9)\)</span>. So, using <code>ppois()</code> we have</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="R-discreteRV.html#cb272-1" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">ppois</span>(<span class="dv">9</span>,<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 0.03182806</code></pre>
</div>
<div class="example">
<p><span id="exm:pois-typos-R" class="example"><strong>Example C.6  </strong></span></p>
<blockquote>
<p>The number <span class="math inline">\(X\)</span> of typos on a page in a textbook follows a Poisson distribution with an average number of 2 typos per page. (a) If you pick a page at random, what is the probability it contains 0 typos? (b) According to this model, 99% of the pages have no more than how many typos?</p>
</blockquote>
<ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="R-discreteRV.html#cb274-1" tabindex="-1"></a><span class="fu">dpois</span>(<span class="dv">0</span>,<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.1353353</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="R-discreteRV.html#cb276-1" tabindex="-1"></a><span class="fu">qpois</span>(.<span class="dv">99</span>,<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 6</code></pre>
</div>
<div class="example">
<p><span id="exm:pois-rutherford-geiger-R" class="example"><strong>Example C.7  (Rutherford/Geiger Data) </strong></span></p>
<blockquote>
<p>In a paper published in 1910 entitled “The Probability Variations in the Distribution of <span class="math inline">\(\alpha\)</span>-particles”, Rutherford and Geiger reported data that counted the number of “scintillations” in 72 second intervals caused by radioactive decay of a quantity of the element polonium.</p>
</blockquote>
<p>Here are the data:</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="R-discreteRV.html#cb278-1" tabindex="-1"></a>results<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">14</span>,<span class="fu">c</span>(<span class="dv">57</span>,<span class="dv">203</span>,<span class="dv">383</span>,<span class="dv">525</span>,<span class="dv">532</span>,<span class="dv">408</span>,<span class="dv">273</span>,<span class="dv">139</span>,<span class="dv">45</span>,<span class="dv">27</span>,<span class="dv">10</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb278-2"><a href="R-discreteRV.html#cb278-2" tabindex="-1"></a>trials<span class="ot">=</span><span class="fu">length</span>(results)</span>
<span id="cb278-3"><a href="R-discreteRV.html#cb278-3" tabindex="-1"></a><span class="fu">table</span>(results)</span></code></pre></div>
<pre><code>## results
##   0   1   2   3   4   5   6   7   8   9  10  11  13  14 
##  57 203 383 525 532 408 273 139  45  27  10   4   1   1</code></pre>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="R-discreteRV.html#cb280-1" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(results)<span class="sc">/</span>trials,</span>
<span id="cb280-2"><a href="R-discreteRV.html#cb280-2" tabindex="-1"></a>        <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">25</span>),</span>
<span id="cb280-3"><a href="R-discreteRV.html#cb280-3" tabindex="-1"></a>        <span class="at">ylab=</span><span class="st">&quot;rel. freq&quot;</span>,</span>
<span id="cb280-4"><a href="R-discreteRV.html#cb280-4" tabindex="-1"></a>        <span class="at">xlab=</span><span class="st">&quot;scintillations&quot;</span>,</span>
<span id="cb280-5"><a href="R-discreteRV.html#cb280-5" tabindex="-1"></a>        <span class="at">main=</span><span class="st">&quot;Rutherford/Geiger Data&quot;</span>)</span></code></pre></div>
<p><img src="math340-notes_files/figure-html/unnamed-chunk-183-1.png" width="672" /></p>
<p>Here’s the mean of the data (which gives average # of scintillations in 72 seconds):</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="R-discreteRV.html#cb281-1" tabindex="-1"></a><span class="fu">mean</span>(results)</span></code></pre></div>
<pre><code>## [1] 3.871549</code></pre>
<p>Let’s compare the observed relative frequencies to the theoretical probabilities associated with a <span class="math inline">\(\texttt{Poisson}(3.87)\)</span> distribution:</p>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-185">Table C.1: </span>Fitting data with a Poisson distribution
</caption>
<thead>
<tr>
<th style="text-align:right;">
x
</th>
<th style="text-align:right;">
rel_freq
</th>
<th style="text-align:right;">
pois_prob
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0219
</td>
<td style="text-align:right;">
0.0209
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0778
</td>
<td style="text-align:right;">
0.0807
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.1469
</td>
<td style="text-align:right;">
0.1562
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.2013
</td>
<td style="text-align:right;">
0.2015
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0.2040
</td>
<td style="text-align:right;">
0.1949
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.1564
</td>
<td style="text-align:right;">
0.1509
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0.1047
</td>
<td style="text-align:right;">
0.0973
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0.0533
</td>
<td style="text-align:right;">
0.0538
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0.0173
</td>
<td style="text-align:right;">
0.0260
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
0.0104
</td>
<td style="text-align:right;">
0.0112
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0.0038
</td>
<td style="text-align:right;">
0.0043
</td>
</tr>
<tr>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0.0015
</td>
<td style="text-align:right;">
0.0015
</td>
</tr>
<tr>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
0.0005
</td>
</tr>
<tr>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
0.0004
</td>
<td style="text-align:right;">
0.0001
</td>
</tr>
<tr>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
0.0004
</td>
<td style="text-align:right;">
0.0000
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="R-discreteRV.html#cb283-1" tabindex="-1"></a><span class="fu">ggplot</span>(df)<span class="sc">+</span></span>
<span id="cb283-2"><a href="R-discreteRV.html#cb283-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(x,pois_prob),<span class="at">col=</span><span class="st">&quot;brown3&quot;</span>,<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb283-3"><a href="R-discreteRV.html#cb283-3" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(x,rel_freq),<span class="at">fill=</span><span class="st">&quot;steelblue&quot;</span>,<span class="at">alpha=</span>.<span class="dv">6</span>, <span class="at">width=</span>.<span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb283-4"><a href="R-discreteRV.html#cb283-4" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Rel freq&quot;</span>)<span class="sc">+</span></span>
<span id="cb283-5"><a href="R-discreteRV.html#cb283-5" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;scintillations&quot;</span>)<span class="sc">+</span></span>
<span id="cb283-6"><a href="R-discreteRV.html#cb283-6" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Comparing relative frequency of the data (bars) to Poisson probabilities (dots)&quot;</span>)<span class="sc">+</span></span>
<span id="cb283-7"><a href="R-discreteRV.html#cb283-7" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="math340-notes_files/figure-html/unnamed-chunk-186-1.png" width="672" /></p>
</div>
</div>
<div id="custom-discrete-R" class="section level2 hasAnchor" number="17.6">
<h2><span class="header-section-number">C.6</span> Homemade Discrete Random Variables<a href="R-discreteRV.html#custom-discrete-R" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s say a discrete random variable <span class="math inline">\(X\)</span> has finite sample space and known probability function <span class="math inline">\(p(x)\)</span>. We often display this type of probability model via a table:</p>
<p><span class="math display">\[
\begin{array}{c|c|c|c|c|c}
x &amp; 5 &amp; 6 &amp; 7 &amp; 8 &amp; 9 \\ \hline
p(x) &amp; 0.1 &amp; 0.1 &amp; 0.3 &amp; 0.4 &amp; 0.1
\end{array}
\]</span>
We can input this model into an R session by defining two vectors:</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="R-discreteRV.html#cb284-1" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>)</span>
<span id="cb284-2"><a href="R-discreteRV.html#cb284-2" tabindex="-1"></a>Px <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.3</span>,<span class="fl">0.4</span>,<span class="fl">0.1</span>)</span></code></pre></div>
<p>We can check in R that the two conditions for a <em>valid</em> probability have been met by this assignment:</p>
<ul>
<li>Each probability is non-negative: <code>Px &gt;= 0</code> = TRUE, TRUE, TRUE, TRUE, TRUE</li>
<li>The probabilities add to 1: <code>sum(Px)</code>= 1</li>
</ul>
<div id="expected-value-of-x" class="section level3 unnumbered hasAnchor">
<h3>Expected Value of <span class="math inline">\(X\)</span><a href="R-discreteRV.html#expected-value-of-x" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Recall if <span class="math inline">\(X\)</span> is a discrete random variable with probability function <span class="math inline">\(p(x),\)</span> then the expected value of <span class="math inline">\(X\)</span> is <span class="math display">\[E(X)=\sum_{\text{all }x}x\cdot p(x)\]</span></p>
<p>Having defined vectors <span class="math inline">\(X\)</span> and <span class="math inline">\(Px\)</span> in R, we calculate <span class="math inline">\(E(X)\)</span> by running</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="R-discreteRV.html#cb285-1" tabindex="-1"></a><span class="fu">sum</span>(X<span class="sc">*</span>Px) </span></code></pre></div>
<pre><code>## [1] 7.3</code></pre>
<p>Note: For those who have taken vector calculus <code>sum(v*w)</code> returns the dot product of <code>v</code> and <code>w</code>, aka the inner product. R has an alternative command for this dot product, which is <code>v %*% w</code>. So, <code>sum(v*w)</code> and <code>v %*% w</code> do the same thing, but I prefer the first option to remind me that the expected value is obtained as a sum over all <span class="math inline">\(x\)</span> of some things.</p>
</div>
<div id="variance-of-x" class="section level3 unnumbered hasAnchor">
<h3>Variance of <span class="math inline">\(X\)</span><a href="R-discreteRV.html#variance-of-x" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Recall the variance of <span class="math inline">\(X\)</span> is <span class="math display">\[V(X) = E[(X-\mu)^2],\]</span> where <span class="math inline">\(\mu = E(X)\)</span>.
Alternatively, the variance can be computed via
<span class="math display">\[V(X) = E(X^2)-\mu^2.\]</span></p>
<p>So we can compute the variance of <span class="math inline">\(X\)</span> in R as follows:</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="R-discreteRV.html#cb287-1" tabindex="-1"></a>mu<span class="ot">=</span><span class="fu">sum</span>(X<span class="sc">*</span>Px) </span>
<span id="cb287-2"><a href="R-discreteRV.html#cb287-2" tabindex="-1"></a>Vx<span class="ot">=</span><span class="fu">sum</span>((X<span class="sc">-</span>mu)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>Px)</span>
<span id="cb287-3"><a href="R-discreteRV.html#cb287-3" tabindex="-1"></a><span class="fu">print</span>(Vx)</span></code></pre></div>
<pre><code>## [1] 1.21</code></pre>
<p>Or, alternatively, as follows:</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="R-discreteRV.html#cb289-1" tabindex="-1"></a>mu<span class="ot">=</span><span class="fu">sum</span>(X<span class="sc">*</span>Px)</span>
<span id="cb289-2"><a href="R-discreteRV.html#cb289-2" tabindex="-1"></a>Vx<span class="ot">=</span><span class="fu">sum</span>(X<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>Px)<span class="sc">-</span>mu<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb289-3"><a href="R-discreteRV.html#cb289-3" tabindex="-1"></a><span class="fu">print</span>(Vx)</span></code></pre></div>
<pre><code>## [1] 1.21</code></pre>
</div>
<div id="distribution-plots" class="section level3 unnumbered hasAnchor">
<h3>Distribution Plots<a href="R-discreteRV.html#distribution-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>R can offer some quick visualizations of probability distributions.</p>
<p>The following code will give the shape of the probability distribution (with a splash of color and plot title:)</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="R-discreteRV.html#cb291-1" tabindex="-1"></a><span class="fu">barplot</span>(Px,<span class="at">names.arg=</span>X, <span class="at">col=</span><span class="st">&quot;steelblue&quot;</span>, <span class="at">main=</span><span class="st">&quot;Probability Model&quot;</span>)</span></code></pre></div>
<p><img src="math340-notes_files/figure-html/unnamed-chunk-191-1.png" width="384" /></p>
</div>
<div id="sampling" class="section level3 unnumbered hasAnchor">
<h3>Sampling<a href="R-discreteRV.html#sampling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The following code draws a sample of size 10 from our distribution using the weighted probabilities assigned by the probability function:</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="R-discreteRV.html#cb292-1" tabindex="-1"></a><span class="fu">sample</span>(X,<span class="dv">10</span>,<span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">prob=</span>Px)</span></code></pre></div>
<pre><code>##  [1] 8 7 7 8 9 7 5 8 6 6</code></pre>
<p>If we take a large sample, and make a relative frequency table of the results, it should be close to the probability table:</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="R-discreteRV.html#cb294-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">table</span>(<span class="fu">sample</span>(X,<span class="dv">10000</span>,<span class="at">replace=</span><span class="cn">TRUE</span>,Px))<span class="sc">/</span>trials,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## 
##     5     6     7     8     9 
## 0.390 0.372 1.155 1.544 0.374</code></pre>
</div>
<div id="discrete-uniform-distribution" class="section level3 hasAnchor" number="17.6.1">
<h3><span class="header-section-number">C.6.1</span> Discrete Uniform Distribution<a href="R-discreteRV.html#discrete-uniform-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="definition">
<p><span id="def:discrete-uniform" class="definition"><strong>Definition C.1  </strong></span>If <span class="math inline">\(X\)</span> is a finite set with size <span class="math inline">\(|X| = n\)</span>. The probability distribution defined by <span class="math display">\[p(x) = \frac{1}{n}\]</span> for all <span class="math inline">\(x \in X\)</span> is called <strong>uniform</strong>.</p>
</div>
<p>In a uniform distribution, we will find over a large number of trials that each name comes up with about the same frequency.</p>
<div class="example">
<p><span id="exm:seals-uniform-R" class="example"><strong>Example C.8  </strong></span></p>
<blockquote>
<p>Pick a random seal from the famous Eddington family: Otto, Ruth, Pluotika, Slarftel, Edgar and Bob.</p>
</blockquote>
<p>To simulate the process of picking one seal at random from the family, a large number of times, we sample 1 element with replacement, a large number of times.</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="R-discreteRV.html#cb296-1" tabindex="-1"></a>family<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;Bob&quot;</span>, <span class="st">&quot;Edgar&quot;</span>, <span class="st">&quot;Pluotika&quot;</span>, <span class="st">&quot;Otto&quot;</span>, <span class="st">&quot;Ruth&quot;</span>, <span class="st">&quot;Slarftel&quot;</span>)</span>
<span id="cb296-2"><a href="R-discreteRV.html#cb296-2" tabindex="-1"></a>results<span class="ot">=</span><span class="fu">sample</span>(family,<span class="dv">10000</span>,<span class="at">replace=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p>The resulting frequency plot should look uniform:</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="R-discreteRV.html#cb297-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(results))<span class="sc">+</span></span>
<span id="cb297-2"><a href="R-discreteRV.html#cb297-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x=</span>results,<span class="at">fill=</span>results))<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&quot;Name&quot;</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">&quot;Pick a seal, any seal!&quot;</span>)<span class="sc">+</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="math340-notes_files/figure-html/unnamed-chunk-195-1.png" width="384" /></p>
<p>Way to go Edgar, you over achiever!</p>
</div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="R-sim-probability.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="R-continuousRV.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["math340-notes.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
